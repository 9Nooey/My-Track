<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìç Tracking</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f0f2f5; font-family: 'Sarabun', sans-serif; padding-top: 20px; }
        .main-card { max-width: 800px; margin: 0 auto; background: white; border-radius: 20px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .header-section { background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%); color: white; padding: 20px; text-align: center; }
        .control-panel { padding: 20px; background: #fff; border-bottom: 1px solid #eee; }
        
        /* ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• iframe */
        .iframe-container { 
            width: 100%; 
            height: 700px; 
            border: none; 
            background: #fff;
            /* ‡∏ã‡πà‡∏≠‡∏ô Scrollbar ‡∏Ç‡∏≠‡∏á iframe ‡∏ñ‡πâ‡∏≤‡∏ó‡∏≥‡πÑ‡∏î‡πâ */
            scrollbar-width: none; 
        }
        
        .btn-shortcut { margin: 5px; border-radius: 20px; font-size: 0.9rem; }
    </style>
</head>
<body>

<div class="container mb-5">
    <div class="main-card">
        <div class="header-section">
            <h2 class="m-0">üöÑ Tracking </h2>
            <p class="small opacity-75 mb-0">‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏£‡∏á‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏£‡∏ñ‡πÑ‡∏ü‡πÅ‡∏´‡πà‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢</p>
        </div>

        <div class="control-panel text-center">
            <div class="row justify-content-center g-2">
                <div class="col-auto">
                    <input type="number" id="trainInput" class="form-control form-control-lg" placeholder="‡πÄ‡∏•‡∏Ç‡∏Ç‡∏ö‡∏ß‡∏ô (‡πÄ‡∏ä‡πà‡∏ô 997)" value="997" style="width: 200px;">
                </div>
                <div class="col-auto">
                    <button class="btn btn-primary btn-lg px-4" onclick="searchTrain()">üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
                </div>
            </div>

            <div class="mt-3">
                <span class="text-muted small">‡∏Ç‡∏ö‡∏ß‡∏ô‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: </span>
                <button class="btn btn-outline-dark btn-shortcut" onclick="quickSearch('997')">997 (‡πÑ‡∏õ‡∏û‡∏•‡∏π‡∏ï‡∏≤‡∏´‡∏•‡∏ß‡∏á)</button>
                <button class="btn btn-outline-dark btn-shortcut" onclick="quickSearch('998')">998 (‡∏Å‡∏•‡∏±‡∏ö‡∏Å‡∏ó‡∏°.)</button>
                <button class="btn btn-outline-dark btn-shortcut" onclick="quickSearch('3')">3 (‡∏î‡πà‡∏ß‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©)</button>
            </div>
        </div>

        <div class="position-relative">
            <div id="loader" class="text-center p-5 d-none">
                <div class="spinner-border text-primary" role="status"></div>
                <p class="mt-2 text-muted">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏î‡∏≤‡∏ß‡πÄ‡∏ó‡∏µ‡∏¢‡∏°‡∏£‡∏ñ‡πÑ‡∏ü...</p>
            </div>

            <iframe id="trainFrame" name="trainFrame" src=""></iframe>
            
            <div id="fallbackBtn" class="text-center p-3 d-none bg-light border-top">
                <p class="text-danger small mb-1">‚ö†Ô∏è ‡∏´‡∏≤‡∏Å‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏Ç‡∏∂‡πâ‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏Ç‡∏≤‡∏ß</p>
                <a id="directLink" href="#" target="_blank" class="btn btn-sm btn-outline-danger">
                    ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà (Popup)
                </a>
            </div>
        </div>
    </div>
</div>

<script>
    // URL ‡∏ï‡∏£‡∏á‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö Tracking ‡∏õ‡∏µ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (V3 Backend)
    // ‡πÄ‡∏£‡∏≤‡πÉ‡∏ä‡πâ searchresult_2024.php ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÅ‡∏ö‡∏ö Card ‡∏™‡∏ß‡∏¢‡πÜ ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô V3
    const BASE_URL = "https://ttsview.railway.co.th/searchresult_2024.php";

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
    window.onload = function() {
        searchTrain(); // ‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (997) ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
    };

    function quickSearch(no) {
        document.getElementById('trainInput').value = no;
        searchTrain();
    }

    function searchTrain() {
        const trainNo = document.getElementById('trainInput').value;
        const iframe = document.getElementById('trainFrame');
        const loader = document.getElementById('loader');
        const fallback = document.getElementById('fallbackBtn');
        const directLink = document.getElementById('directLink');

        if (!trainNo) return;

        // 1. ‡∏™‡∏£‡πâ‡∏≤‡∏á URL
        // lang=th ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢
        const targetUrl = `${BASE_URL}?trainno=${trainNo}&lang=th`;

        // 2. ‡πÅ‡∏™‡∏î‡∏á Loader / ‡∏ã‡πà‡∏≠‡∏ô Iframe ‡∏Å‡πà‡∏≠‡∏ô
        loader.classList.remove('d-none');
        iframe.style.opacity = "0";

        // 3. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Iframe
        iframe.src = targetUrl;
        
        // 4. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏≥‡∏£‡∏≠‡∏á (‡πÄ‡∏ú‡∏∑‡πà‡∏≠ Iframe ‡πÇ‡∏î‡∏ô‡∏ö‡∏•‡πá‡∏≠‡∏Å)
        directLink.href = targetUrl;

        // 5. ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
        iframe.onload = function() {
            loader.classList.add('d-none');
            iframe.style.opacity = "1";
            fallback.classList.remove('d-none'); // ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏≥‡∏£‡∏≠‡∏á‡πÑ‡∏ß‡πâ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏™‡∏°‡∏≠ ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏õ‡∏¥‡∏î‡∏à‡∏≠‡πÉ‡∏´‡∏ç‡πà
        };
    }
</script>

</body>
</html>
